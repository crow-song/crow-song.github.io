<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222"/>




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2"/>



















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0"/>

<link rel="stylesheet" href="/css/main.css?v=7.2.0"/>


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.2.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png?v=7.2.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.2.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.2.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.2.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="springboot 使用mybatis 分层  https://www.cnblogs.com/smfx1314/p/9689824.html  DDD 风格分层架构遵循基本的分层架构风格。  User Interface —— 用户接口层。对外提供各种协议形式的服务，并提供Validation参数校验，authenticate权限认证，业务实体组装器Assembler等。图中标绿组件。 App">
<meta name="keywords" content="springboot">
<meta property="og:type" content="article">
<meta property="og:title" content="springBootDDD">
<meta property="og:url" content="http://yoursite.com/2019/11/20/springBootDDD/index.html">
<meta property="og:site_name" content="crowsongのblog">
<meta property="og:description" content="springboot 使用mybatis 分层  https://www.cnblogs.com/smfx1314/p/9689824.html  DDD 风格分层架构遵循基本的分层架构风格。  User Interface —— 用户接口层。对外提供各种协议形式的服务，并提供Validation参数校验，authenticate权限认证，业务实体组装器Assembler等。图中标绿组件。 App">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-01-20T09:31:56.017Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="springBootDDD">
<meta name="twitter:description" content="springboot 使用mybatis 分层  https://www.cnblogs.com/smfx1314/p/9689824.html  DDD 风格分层架构遵循基本的分层架构风格。  User Interface —— 用户接口层。对外提供各种协议形式的服务，并提供Validation参数校验，authenticate权限认证，业务实体组装器Assembler等。图中标绿组件。 App">



  <link rel="alternate" href="/atom.xml" title="crowsongのblog" type="application/atom+xml"/>



  
  
  <link rel="canonical" href="http://yoursite.com/2019/11/20/springBootDDD/"/>



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>springBootDDD | crowsongのblog</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>
<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

<script src="https://crow-song.github.io/live2d-widget/autoload.js"></script>
  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">crowsongのblog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br/>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br/>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br/>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br/>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br/>归档</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br/>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/20/springBootDDD/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="crowsong"/>
      <meta itemprop="description" content="日々私たちが过ごしている日常は、実は、奇迹の连続なのかもしれない"/>
      <meta itemprop="image" content="/images/shuvi.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="crowsongのblog"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">springBootDDD

              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-11-20 14:58:09" itemprop="dateCreated datePublished" datetime="2019-11-20T14:58:09+08:00">2019-11-20</time>
            </span>
          

          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-01-20 17:31:56" itemprop="dateModified" datetime="2020-01-20T17:31:56+08:00">2020-01-20</time>
              </span>
            
          

          

          
            
            
          

          
          

          

          <br/>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>springboot 使用mybatis 分层</p>
<blockquote>
<p><a href="https://www.cnblogs.com/smfx1314/p/9689824.html" target="_blank" rel="noopener">https://www.cnblogs.com/smfx1314/p/9689824.html</a></p>
</blockquote>
<h5 id="DDD-风格分层架构"><a href="#DDD-风格分层架构" class="headerlink" title="DDD 风格分层架构"></a>DDD 风格分层架构</h5><p>遵循基本的分层架构风格。</p>
<ul>
<li>User Interface —— 用户接口层。对外提供各种协议形式的服务，并提供Validation参数校验，authenticate权限认证，业务实体组装器Assembler等。图中标绿组件。</li>
<li>Application —— 应用服务层。组合多个业务实体、基础设施层的各种组件完成业务服务。图中标黄部分。</li>
<li>Domain —— 业务领域层。DDD概念中的核心业务层，封装所有业务逻辑，包含entity、value object、domain service、domain event等。图中标蓝部分。</li>
<li>Infrastructure —— 基础设施层。提供公共组件，如：Logging、Trascation、HttpClient等。图中标灰部分。</li>
</ul>
<blockquote>
<p><a href="https://www.cnblogs.com/daoqidelv/p/7499244.html" target="_blank" rel="noopener">https://www.cnblogs.com/daoqidelv/p/7499244.html</a></p>
</blockquote>
<a id="more"></a>
<hr>
<h5 id="eureka-使用"><a href="#eureka-使用" class="headerlink" title="eureka 使用"></a>eureka 使用</h5><p>服务端：</p>
<p>idea 使用 springboot Initializr 初始化项目，选择  spring Cloud Discovery -&gt; Eureka Server</p>
<p>在 Application 注解 @EnableEurekaServer</p>
<p>application.properties 中配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">server.port: 8761</span><br><span class="line">#应用的主机名称</span><br><span class="line">eureka.instance.hostname: localhost</span><br><span class="line">#值为false意味着自身仅作为服务器，不作为客户端</span><br><span class="line">eureka.client.registerWithEureka: false</span><br><span class="line">#值为false意味着无需注册自身</span><br><span class="line">eureka.client.fetchRegistry: false</span><br><span class="line"># 指明了应用的URL</span><br><span class="line">eureka.client.serviceUrl.defaultZone: http://$&#123;eureka.instance.hostname&#125;:$&#123;server.port&#125;/eureka/</span><br></pre></td></tr></table></figure>
<p>客户端：</p>
<p>idea 使用 springboot Initializr 初始化项目，选择  spring Cloud Discovery -&gt; Eureka Discovery Client</p>
<p>在 Application 上注释 @EnableDiscoveryClient</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#注册名</span><br><span class="line">spring.application.name: micro-weather-eureka-client</span><br><span class="line">#服务器地址</span><br><span class="line">eureka.client.service-url.defaultZone: http://localhost:9091/eureka/</span><br></pre></td></tr></table></figure>
<hr>
<h5 id="springboot-配合-jpa-多数据源配置"><a href="#springboot-配合-jpa-多数据源配置" class="headerlink" title="springboot 配合 jpa 多数据源配置"></a>springboot 配合 jpa 多数据源配置</h5><p>如果没有 <code>jpaProperties.getHibernateProperties(hibernateSettings);</code> 方法，则可能是 springboot 版本为 2.2 以上，换低版本可解决，如 2.0.3 。如果在 1.x 版本的 springboot 依赖的 hibernate 方法也不一样，getHibernateProperties 方法的参数也有区别</p>
<blockquote>
<p>代码参考：<a href="https://github.com/crow-song/SpringBootJpaChangeDB" target="_blank" rel="noopener">https://github.com/crow-song/SpringBootJpaChangeDB</a></p>
</blockquote>
<blockquote>
<p>参考：<a href="https://blog.csdn.net/qq_26440803/article/details/83316743" target="_blank" rel="noopener">https://blog.csdn.net/qq_26440803/article/details/83316743</a></p>
<p><a href="https://www.jianshu.com/p/c207f53ba63c" target="_blank" rel="noopener">https://www.jianshu.com/p/c207f53ba63c</a></p>
</blockquote>
<h5 id="idea-使用-maven-打-jar-包"><a href="#idea-使用-maven-打-jar-包" class="headerlink" title="idea 使用 maven 打 jar 包"></a>idea 使用 maven 打 jar 包</h5><p>有问题可以尝试：以下几个 pom 配置，按需取</p>
<p><code>&lt;packing&gt;jar&lt;/packing&gt;</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fork</span>&gt;</span>true<span class="tag">&lt;/<span class="name">fork</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&lt;mainClass&gt;com.micro.weather.eureka.client.eureka.EurekaClientApplication&lt;/mainClass&gt;--&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>右边 maven LifeStyle 执行 clean ，package</p>
<p>在 jar 包上可以直接重命名</p>
<h5 id="jar-包后台运行"><a href="#jar-包后台运行" class="headerlink" title="jar 包后台运行"></a>jar 包后台运行</h5><p><code>nohup java -jar venues.jar &gt;temp.txt &amp;</code></p>
<p><code>jobs</code> 查看后台</p>
<p><code>fg 233</code> fg + 编号将任务调回前台</p>
<p><code>netstat -nlp |grep :9181</code></p>
<p>查看某端口占用的线程的pid</p>
<p><code>netstat -nlp |grep :9181</code></p>
<p>jobs -l 查看后台的进程</p>
<p>查询进程排除 gerp 进程，提取进程号</p>
<p><code>ps -ef|grep tomcat|grep -v grep|awk &#39;{print $2}&#39;</code></p>
<p>查看某端口的进程</p>
<p><code>lsof -i :9080</code></p>
<blockquote>
<p>参考：<a href="https://blog.csdn.net/qq_30739519/article/details/51115075" target="_blank" rel="noopener">https://blog.csdn.net/qq_30739519/article/details/51115075</a></p>
</blockquote>
<blockquote>
<p>参考：<a href="https://waylau.com/eureke-server-register-and-server-discovery/" target="_blank" rel="noopener">https://waylau.com/eureke-server-register-and-server-discovery/</a></p>
</blockquote>
<blockquote>
<p>参考：<a href="https://www.cnblogs.com/baby123/p/6477429.html" target="_blank" rel="noopener">https://www.cnblogs.com/baby123/p/6477429.html</a></p>
</blockquote>
<hr>
<h5 id="springboot-yml-profile-不同环境配置"><a href="#springboot-yml-profile-不同环境配置" class="headerlink" title="springboot yml-profile 不同环境配置"></a>springboot yml-profile 不同环境配置</h5><p>如果使用YAML来配置属性，则可以遵循与配置文件相同的命名规范，即创建application-{profile}.yml这样的YAML文件，并将与Profile无关的属性继续放在application.yml里</p>
<blockquote>
<p>参考:<a href="https://cloud.tencent.com/developer/article/1079847" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1079847</a></p>
<p>参考：<a href="https://www.jianshu.com/p/6ac270aac03e" target="_blank" rel="noopener">https://www.jianshu.com/p/6ac270aac03e</a></p>
</blockquote>
<hr>
<h5 id="springboot-多数据源配置-JPA"><a href="#springboot-多数据源配置-JPA" class="headerlink" title="springboot 多数据源配置 JPA"></a>springboot 多数据源配置 JPA</h5><blockquote>
<p>参考：<a href="https://blog.csdn.net/qq_26440803/article/details/83316743" target="_blank" rel="noopener">https://blog.csdn.net/qq_26440803/article/details/83316743</a></p>
</blockquote>
<hr>
<h5 id="springboot-jpa-ddl-auto-选择"><a href="#springboot-jpa-ddl-auto-选择" class="headerlink" title="springboot jpa ddl-auto 选择"></a>springboot jpa ddl-auto 选择</h5><ul>
<li>create表示每次应用启动的时候，都会将之前的表全部drop掉，重新根据实体类生成一遍。</li>
<li>create-drop在create的基础上，在应用关闭的时候还会drop一次。</li>
<li>update可能是比较常用的，每次启动的时候会看看实体类有什么变化，然后看需不需要更改表结构。</li>
<li>validate不会对表进行更改，但是会看看他和实体类是否对应</li>
<li>none什么都不做</li>
</ul>
<p>一般在测试时可以使用 create-drop 或 update，生产环境不要使用 ddl-auto</p>
<blockquote>
<p>We do it in production albeit with an application that’s not mission critical and with no highly paid DBAs on staff. It’s just one less manual process that’s subject to human error - the application can detect the difference and do the right thing, plus you’ve presumably tested it in various development and test environments.</p>
<p>One caveat - in a clustered environment you may want to avoid it because multiple apps can come up at the same time and try to modify the schema which could be bad. Or put in some mechanism where only one instance is allowed to update the schema.</p>
</blockquote>
<blockquote>
<p>参考:<a href="https://blog.csdn.net/u012930316/article/details/76718744" target="_blank" rel="noopener">springboot data JPA的spring.jpa.hibernate.ddl-auto 的见解思考</a></p>
<p><a href="https://stackoverflow.com/questions/221379/hibernate-hbm2ddl-auto-update-in-production" target="_blank" rel="noopener">Hibernate: hbm2ddl.auto=update in production?</a></p>
</blockquote>
<hr>
<h5 id="springbootJPA-返回-DTO-值问题"><a href="#springbootJPA-返回-DTO-值问题" class="headerlink" title="springbootJPA 返回 DTO 值问题"></a>springbootJPA 返回 DTO 值问题</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">JpaAccountPORepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">Account</span>,<span class="title">String</span>&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Query</span>(value=<span class="string">"select new com.springboot.jpadata.application.api.response.AccountResponseDTO("</span> +</span><br><span class="line">            <span class="string">"a.id,a.name,a.money) "</span> +</span><br><span class="line">            <span class="string">"from Account a"</span>)</span><br><span class="line">    <span class="function">List&lt;AccountResponseDTO&gt; <span class="title">queryAllAccounts</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果只是要查询后返回 ResponseDTO 的部分值，需要在 DTO 中创建只包含那几个值的构造函数，</p>
<p>有 DTO 字段为 null 的情况可以把那几个 null 的字段去掉</p>
<hr>
<h5 id="JPA-Query-模糊查询"><a href="#JPA-Query-模糊查询" class="headerlink" title="JPA @Query 模糊查询"></a>JPA @Query 模糊查询</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Query</span>(<span class="string">"SELECT u.username FROM User u WHERE u.username LIKE CONCAT('%',:username,'%')"</span>)</span><br><span class="line"><span class="function">List&lt;String&gt; <span class="title">findUsersWithPartOfName</span><span class="params">(@Param(<span class="string">"username"</span>)</span> String username)</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>出处：<a href="https://stackoverflow.com/questions/21456494/spring-jpa-query-with-like" target="_blank" rel="noopener">https://stackoverflow.com/questions/21456494/spring-jpa-query-with-like</a></p>
</blockquote>
<hr>
<h5 id="springboot-restful-风格"><a href="#springboot-restful-风格" class="headerlink" title="springboot restful 风格"></a>springboot restful 风格</h5><blockquote>
<p><a href="https://mp.weixin.qq.com/s/XQURTg5we4RqmDzYzouURA" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/XQURTg5we4RqmDzYzouURA</a></p>
</blockquote>
<hr>
<h5 id="springboot-整合-mybatis-实现-sql-输出"><a href="#springboot-整合-mybatis-实现-sql-输出" class="headerlink" title="springboot 整合 mybatis 实现 sql 输出"></a>springboot 整合 mybatis 实现 sql 输出</h5><p>在 logback-spring.xml 文件中配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 设置包打印日志级别 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>= <span class="string">"com.jinhaoxun.acapply.dao.applyMapper"</span> <span class="attr">level</span>=<span class="string">"TRACE"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>打印日志级别，为 TRACE 或 DEBUG 就能打印出 sql</p>
<p>其中 name 可为类名或者一个目录名</p>
<blockquote>
<p>参考：<a href="https://www.jianshu.com/p/a7f1a33b9825" target="_blank" rel="noopener">springboot项目配置logback打印日志，并自定义日志级别打印mybatis的sql语句</a></p>
</blockquote>
<hr>
<h4 id="Q-amp-A"><a href="#Q-amp-A" class="headerlink" title="Q&amp;A"></a>Q&amp;A</h4><h5 id="Q-springboot-启动报错-failed-to-load-driver-class"><a href="#Q-springboot-启动报错-failed-to-load-driver-class" class="headerlink" title="Q:springboot 启动报错 failed to load driver class"></a>Q:springboot 启动报错 failed to load driver class</h5><p>A:</p>
<p><code>failed to load driver class oracle.jdbc.oracledriver in either of hikariConfig class loader or Thread tontext classloader</code></p>
<p>启动报错，需要在 maven 添加</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.oracle<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ojdbc7<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">version</span>&gt;</span>12.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<h5 id="Q-springboot-启动报错-Not-a-managed-type"><a href="#Q-springboot-启动报错-Not-a-managed-type" class="headerlink" title="Q:springboot 启动报错 Not a managed type:"></a>Q:springboot 启动报错 Not a managed type:</h5><p>Not a managed type: class com.springboot.jpadata.infrastructure.persistence.po.master.Users</p>
<p>A：没有注入实体类，看报错的实体类是哪个，加上 @Entiry 或其他对应的注解</p>
<blockquote>
<p>参考:<a href="https://blog.csdn.net/u012930316/article/details/76718744" target="_blank" rel="noopener">spring data jpa 出现Not a managed type</a></p>
</blockquote>
<hr>
<h5 id="Q-springbootlogback-出现报错"><a href="#Q-springbootlogback-出现报错" class="headerlink" title="Q:springbootlogback 出现报错"></a>Q:springbootlogback 出现报错</h5><p>A:16:46:33,199 |-ERROR in ch.qos.logback.core.rolling.RollingFileAppender[FILE] - openFile(/var/log/opentsdb/opentsdb.log,true) call failed. java.io.FileNotFoundException:</p>
<p>没有该路径，需要手动创建，或者在 logback-spring.xml 中配置 fileNamePattern</p>
<hr>
<h5 id="Q-Unsupported-major-minor-version-52-0"><a href="#Q-Unsupported-major-minor-version-52-0" class="headerlink" title="Q:Unsupported major.minor version 52.0"></a>Q:Unsupported major.minor version 52.0</h5><p>A:</p>
<p>直译过来意思是：不支持version52.0，其中version 52.0是魔码的其中一个版本，他对应的是jdk1.8</p>
<p>所以异议过来就是：不支持jdk1.8</p>
<p>简单来说，就是执行环境的jdk版本 低于 编译的jdk版本</p>
<p>jar 包编译时使用了 jdk 1.8,但是 linux 上使用的是 1.7 版本导致 java -jar 报错</p>
<blockquote>
<p>参考：<a href="https://blog.csdn.net/qq_36769100/article/details/78880341" target="_blank" rel="noopener">https://blog.csdn.net/qq_36769100/article/details/78880341</a></p>
</blockquote>
<hr>
<h5 id="Q-springboot-jar-包启动报错端口被占用"><a href="#Q-springboot-jar-包启动报错端口被占用" class="headerlink" title="Q:springboot jar 包启动报错端口被占用"></a>Q:springboot jar 包启动报错端口被占用</h5><p>The Tomcat connector configured to listen on port 8080 failed to start. The port may already be in use or the connector may be misconfigured.</p>
<p>A:java -jar demo.jar –server.port=9090</p>
<hr>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        
          
        
        <div class="post-tags">
          
            <a href="/tags/springboot/" rel="tag"># springboot</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/11/01/tenthPower/" rel="next" title="tenthPower">
                <i class="fa fa-chevron-left"></i> tenthPower
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/01/13/linuxShell/" rel="prev" title="linuxShell">
                linuxShell <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/shuvi.gif"
                alt="crowsong"/>
            
              <p class="site-author-name" itemprop="name">crowsong</p>
              <div class="site-description motion-element" itemprop="description">日々私たちが过ごしている日常は、実は、奇迹の连続なのかもしれない</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">43</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">11</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">45</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/crow-song" title="GitHub &rarr; https://github.com/crow-song" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="/crowsong.end@gmail.com" title="E-Mail &rarr; crowsong.end@gmail.com"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-5"><a class="nav-link" href="#DDD-风格分层架构"><span class="nav-number">1.</span> <span class="nav-text">DDD 风格分层架构</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#eureka-使用"><span class="nav-number">2.</span> <span class="nav-text">eureka 使用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#springboot-配合-jpa-多数据源配置"><span class="nav-number">3.</span> <span class="nav-text">springboot 配合 jpa 多数据源配置</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#idea-使用-maven-打-jar-包"><span class="nav-number">4.</span> <span class="nav-text">idea 使用 maven 打 jar 包</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#jar-包后台运行"><span class="nav-number">5.</span> <span class="nav-text">jar 包后台运行</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#springboot-yml-profile-不同环境配置"><span class="nav-number">6.</span> <span class="nav-text">springboot yml-profile 不同环境配置</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#springboot-多数据源配置-JPA"><span class="nav-number">7.</span> <span class="nav-text">springboot 多数据源配置 JPA</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#springboot-jpa-ddl-auto-选择"><span class="nav-number">8.</span> <span class="nav-text">springboot jpa ddl-auto 选择</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#springbootJPA-返回-DTO-值问题"><span class="nav-number">9.</span> <span class="nav-text">springbootJPA 返回 DTO 值问题</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#JPA-Query-模糊查询"><span class="nav-number">10.</span> <span class="nav-text">JPA @Query 模糊查询</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#springboot-restful-风格"><span class="nav-number">11.</span> <span class="nav-text">springboot restful 风格</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#springboot-整合-mybatis-实现-sql-输出"><span class="nav-number">12.</span> <span class="nav-text">springboot 整合 mybatis 实现 sql 输出</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Q-amp-A"><span class="nav-number"></span> <span class="nav-text">Q&amp;A</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Q-springboot-启动报错-failed-to-load-driver-class"><span class="nav-number">1.</span> <span class="nav-text">Q:springboot 启动报错 failed to load driver class</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Q-springboot-启动报错-Not-a-managed-type"><span class="nav-number">2.</span> <span class="nav-text">Q:springboot 启动报错 Not a managed type:</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Q-springbootlogback-出现报错"><span class="nav-number">3.</span> <span class="nav-text">Q:springbootlogback 出现报错</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Q-Unsupported-major-minor-version-52-0"><span class="nav-number">4.</span> <span class="nav-text">Q:Unsupported major.minor version 52.0</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Q-springboot-jar-包启动报错端口被占用"><span class="nav-number">5.</span> <span class="nav-text">Q:springboot jar 包启动报错端口被占用</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">crowsong</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.2.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=3.4.1"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.2.0"></script>

  <script src="/js/motion.js?v=7.2.0"></script>



  
  


  <script src="/js/affix.js?v=7.2.0"></script>

  <script src="/js/schemes/pisces.js?v=7.2.0"></script>



  
  <script src="/js/scrollspy.js?v=7.2.0"></script>
<script src="/js/post-details.js?v=7.2.0"></script>



  


  <script src="/js/next-boot.js?v=7.2.0"></script>


  

  

  

  


  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  

  

  

  

  

  

  

  

  

<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
